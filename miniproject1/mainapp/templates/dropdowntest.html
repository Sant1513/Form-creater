<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Dropdown</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'styles6.css' %}">
</head>
<body>
    <div class="dropdown-container">
        <input type="text" id="search-input" placeholder="Type to search..." autocomplete="off">
        <ul id="dropdown-menu" class="hidden"></ul>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const input = document.getElementById('search-input');
            const dropdownMenu = document.getElementById('dropdown-menu');

            input.addEventListener('input', () => {
                const query = input.value.trim();
                if (query === '') {
                    dropdownMenu.classList.add('hidden');
                    dropdownMenu.innerHTML = '';
                    return;
                }

                fetch('/get-choices/?q='+encodeURIComponent(query))
                    .then(response =>{
                        console.log("Response status:", response.status);
                        return response.json();
                    })
                    .then(choices => {
                        console.log("Choices received:", choices);
                        dropdownMenu.innerHTML = '';
                        if (choices.length > 0) {
                            choices.forEach(choice => {
                                const li = document.createElement('li');
                                li.textContent = choice;
                                li.addEventListener('click', () => {
                                    input.value = choice;
                                    dropdownMenu.classList.add('hidden');
                                });
                                dropdownMenu.appendChild(li);
                            });
                            dropdownMenu.classList.remove('hidden');
                        } else {
                            dropdownMenu.classList.add('hidden');
                        }
                    })
                    .catch(error => console.error('Error fetching choices:', error));
            });
        });

    </script>
</body>
</html>
